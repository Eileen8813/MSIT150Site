
@{
    ViewData["Title"] = "homework5";
}

<h1>homework5</h1>
<div class="row">
    <div class="col-3"></div>
    <div class="col-6">

<form id="form1">
    <div class="mb-3">
      
    </div>
    <div class="mb-3">
                <label for="textname" class="form-label">姓名</label>
                <input type="text" class="form-control" id="textname" name="name">
    </div>
    <div class="mb-3">
       
    </div>
            <div class="mb-3">
                <label for="textEmail" class="form-label">Email</label>
                <input type="text" class="form-control" id="textEmail" name="Email">
            </div>


    <div class="mb-3">
                <label for="textold" class="form-label">年齡</label>
                <input type="text" class="form-control" id="textold" name="Age">
    </div>


            <div class="mb-3">
                <label for="formFile" class="form-label">Default file input example</label>
                <input class="form-control" type="file" name="file" id="file">
            </div>

            <div>
                <p>預覽</p><img src="" id="picturebox" style="height:100px;width:100px;"></img>
            </div>


    <button type="submit" id="button1">送出</button>
            
   

</form>
        <div class="alert alert-info" id="div1"></div>
    </div>
</div>
@section Styles{
    <style>
    </style>

}
@section Scripts{
    <script>
        const btn1 = document.querySelector('#button1');
        const thediv = document.querySelector('#div1');
        const picturebox = document.querySelector('#picturebox');



      btn1.addEventListener('click',event=>{
          event.preventDefault();
      
      //新版Fetch

        const fetchdata =new FormData( document.querySelector('#form1'));
        fetch('@Url.Content("/api/Register")', {
            body: fetchdata,method: 'Post'
        }
        )
        .then(response=>{
        if(response.ok){
            alert("新增成功")
            location.host='@Url.Content("/members")'
        }
        else{
                    alert("XXX")
        }
                })
                })

        const thefile = document.querySelector('#file');
        
                //作業五
        var fileReader = new FileReader();
        thefile.addEventListener('change',()=>{
           // console.log(thefile.name);
           if( thefile.name!=null){
                fileReader.readAsDataURL(thefile.files[0]);
           }
                //console.log(thefile.name);
                fileReader.addEventListener("load",()=> {
                picturebox.src = fileReader.result;
                 
                })
          
        })


    </script>
}
